;; Simple module test
;; Tests basic module functionality and dotted namespace access

;; Define a simple math module
(module math (export add sub)
  (define add (lambda (x y) (+ x y)))
  (define sub (lambda (x y) (- x y))))

;; Test 1: Direct import (all symbols)
(print "Test 1: direct import all symbols")
(import math)
(assert (= (add 5 3) 8))
(assert (= (sub 10 3) 7))
(print "Direct import works!")

;; Test 2: Dotted namespace access with :as
(print "Test 2: dotted namespace access with :as")
(import math :as m)
(assert (= (m.add 10 5) 15))
(assert (= (m.sub 10 3) 7))
(print "Dotted notation works!")

;; Test 3: Multiple modules with dotted access
(print "Test 3: multiple modules with dotted access")
(module utils (export double triple)
  (define double (lambda (x) (* x 2)))
  (define triple (lambda (x) (* x 3))))

(import utils :as u)
(assert (= (u.double 5) 10))
(assert (= (u.triple 5) 15))
(assert (= (m.add (u.double 2) 3) 7))
(print "Multiple modules work!")

;; Test 4: Selective import
(print "Test 4: selective import")
(module calc (export add multiply divide)
  (define add (lambda (x y) (+ x y)))
  (define multiply (lambda (x y) (* x y)))
  (define divide (lambda (x y) (/ x y))))

(import calc add multiply)
(assert (= (add 2 3) 5))
(assert (= (multiply 3 4) 12))
(print "Selective import works!")

(print "")
(print "All simple module tests passed!")
