;; ============================================================================
;; Test Suite: Functions
;; Description: Tests for lambda expressions and function definitions
;; ============================================================================

;; Test: Simple lambda
(define add (lambda (x y) (+ x y)))
(add 5 3)                     ;; Expected: 8
(add 10 20)                   ;; Expected: 30

;; Test: Lambda with single parameter
(define double (lambda (x) (* x 2)))
(double 5)                    ;; Expected: 10
(double 21)                   ;; Expected: 42

;; Test: Lambda with no parameters
(define get-constant (lambda () 42))
(get-constant)                ;; Expected: 42

;; Test: Function definition with defun
(defun square (n) (* n n))
(square 5)                    ;; Expected: 25
(square 7)                    ;; Expected: 49

;; Test: Recursive function (factorial)
(defun factorial (n)
  (if (== n 0)
     1
     (* n (factorial (- n 1)))))
(factorial 5)                 ;; Expected: 120
(factorial 0)                 ;; Expected: 1
(factorial 3)                 ;; Expected: 6

;; Test: Recursive function (fibonacci)
(defun fib (n)
  (if (< n 2)
     n
     (+ (fib (- n 1)) (fib (- n 2)))))
(fib 0)                       ;; Expected: 0
(fib 1)                       ;; Expected: 1
(fib 6)                       ;; Expected: 8
(fib 8)                       ;; Expected: 21

;; Test: Higher-order function
(define apply-twice (lambda (f x) (f (f x))))
(defun inc (n) (+ n 1))
(apply-twice inc 5)           ;; Expected: 7

;; Test: Function returning function
(define make-adder (lambda (n) (lambda (x) (+ x n))))
(define add5 (make-adder 5))
(add5 10)                     ;; Expected: 15
