;; ============================================================================
;; Test Suite: Module System
;; Description: Tests for module definition, import, and exports
;; ============================================================================

;; Test: Simple module with variable export
(module math-constants (export pi e)
  (define pi 3.14159)
  (define e 2.71828))

(import math-constants)
pi                            ;; Expected: 3.14159
e                             ;; Expected: 2.71828

;; Test: Module with function export
(module arithmetic (export add subtract multiply)
  (define add (lambda (x y) (+ x y)))
  (define subtract (lambda (x y) (- x y)))
  (define multiply (lambda (x y) (* x y))))

(import arithmetic)
(add 10 5)                    ;; Expected: 15
(subtract 10 5)               ;; Expected: 5
(multiply 10 5)               ;; Expected: 50

;; Test: Selective import
(module utils (export public-fn private-fn)
  (define public-fn (lambda (x) (* x 2)))
  (define private-fn (lambda (x) (+ x 1))))

(import utils public-fn)
(public-fn 5)                 ;; Expected: 10

;; Test: Module with internal state
(module counter-mod (export increment get-count reset)
  (define count 0)
  (define increment (lambda ()
    (define count (+ count 1))
    count))
  (define get-count (lambda () count))
  (define reset (lambda ()
    (define count 0)
    count)))

(import counter-mod)
(increment)                   ;; Expected: 1
(increment)                   ;; Expected: 2
(get-count)                   ;; Expected: 2
(reset)                       ;; Expected: 0
(increment)                   ;; Expected: 1

;; Test: Module with closure
(module closure-mod (export get-value)
  (define value 42)
  (define get-value (lambda () value)))

(import closure-mod)
(get-value)                   ;; Expected: 42

;; Test: Import with alias
(module string-utils (export concat length)
  (define concat (lambda (a b) (list a b)))
  (define length (lambda (s) 5)))

(import string-utils :as str)
str                           ;; Should be module object
