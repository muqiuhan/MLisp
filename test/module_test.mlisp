;; Module system test

;; Define a simple math module
(module math (export add sub mul)
  (:= add (=> (x y) (+ x y)))
  (:= sub (=> (x y) (- x y)))
  (:= mul (=> (x y) (* x y))))

;; Import all symbols from math module
(import math)

;; Test imported functions
(add 5 3)
(sub 10 4)
(mul 2 7)

;; Define another module with selective exports
(module utils (export greet capitalize)
  (:= greet (=> (name) (@ "Hello, " name "!")))
  (:= capitalize (=> (str) str))
  (:= internal-helper (=> (x) x)))

;; Import specific symbols
(import utils greet)

;; Test selective import
(greet "MLisp")

;; Test that internal-helper is not accessible (should fail if uncommented)
;; (internal-helper "test")

;; Define a module with namespace import
(module string-ops (export concat length)
  (:= concat (=> (a b) (@ a b)))
  (:= length (=> (s) 0)))

;; Import with alias
(import string-ops :as str)

;; Test namespace import (note: this requires dot notation support in symbol lookup)
;; For now, we'll test that the module was imported
str

;; Nested module test
(module outer (export get-value)
  (:= value 42)
  (:= get-value (=> () value)))

(import outer)

(get-value)
